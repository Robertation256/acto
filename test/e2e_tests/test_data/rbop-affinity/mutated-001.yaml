apiVersion: rabbitmq.com/v1beta1
kind: RabbitmqCluster
metadata:
  name: test-cluster
  namespace: rabbitmq-system
spec:
  affinity:
    podAffinity:
      requiredDuringSchedulingIgnoredDuringExecution: null
    podAntiAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
      - labelSelector:
          matchExpressions:
          - key: app.kubernetes.io/name
            operator: In
            values:
            - test-cluster
        topologyKey: kubernetes.io/hostname
  image: null
  imagePullSecrets: null
  override:
    statefulSet:
      spec:
        template:
          spec:
            affinity:
              podAntiAffinity:
                requiredDuringSchedulingIgnoredDuringExecution:
                - labelSelector:
                    matchExpressions:
                    - key: app.kubernetes.io/name
                      operator: In
                      values:
                      - test-cluster
                  topologyKey: kubernetes.io/hostname
            containers: []
  persistence:
    storage: 1Gi
  rabbitmq:
    additionalConfig: 'cluster_partition_handling = pause_minority

      vm_memory_high_watermark_paging_ratio = 0.99

      disk_free_limit.relative = 1.0

      collect_statistics_interval = 10000

      '
  replicas: 5   # this is unsatisfiable 
  resources:
    limits:
      cpu: 1
      memory: 1Gi
    requests:
      cpu: 1
      memory: 1Gi
  secretBackend: null
  service:
    type: ClusterIP
  skipPostDeploySteps: false
  terminationGracePeriodSeconds: 1024
  tls:
    caSecretName: null
    disableNonTLSListeners: false
    secretName: null
  tolerations: null




  {
    "type":"MODIFIED",
    "object":{
      "kind":"Event",
      "apiVersion":"v1",
      "metadata":{
        "name":"test-cluster-server-4.17c46b601dee87c1",
        "namespace":"rabbitmq-system",
        "uid":"fb74ac2b-2a1a-4ee8-b2c2-45f8b666c117",
        "resourceVersion":"1551",
        "creationTimestamp":"2024-04-08T21:30:18Z",
        "managedFields":[
          {"manager":"kube-scheduler","operation":"Update","apiVersion":"v1","time":"2024-04-08T21:30:18Z","fieldsType":"FieldsV1","fieldsV1":{"f:count":{},"f:firstTimestamp":{},"f:involvedObject":{},"f:lastTimestamp":{},"f:message":{},"f:reason":{},"f:source":{"f:component":{}},"f:type":{}}}]},
          "involvedObject":{
            "kind":"Pod",
            "namespace":"rabbitmq-system",
            "name":"test-cluster-server-4",
            "uid":"a86c7ab6-36ed-43d5-97de-e3785e25aaff",
            "apiVersion":"v1",
            "resourceVersion":"1307"
          },
          "reason":"FailedScheduling",
          "message":"0/4 nodes are available: 1 node(s) had taint {node-role.kubernetes.io/master: }, that the pod didn\'t tolerate, 3 node(s) didn\'t match pod anti-affinity rules.",
          "source":{"component":"default-scheduler"},
          "firstTimestamp":"2024-04-08T21:30:18Z","lastTimestamp":"2024-04-08T21:31:36Z","count":2,"type":"Warning","eventTime":null,"reportingComponent":"","reportingInstance":""}}

